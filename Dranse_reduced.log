// --------------------------------------------------
// BASEMENT log file:
// Version:  v2.8.2// bmc file: C:\Users\marga\Documents\EPFL\Cours\S3\Dranse\BASEMENT_model\Dranse_sediment\Dranse_reduced.bmc
// started:  Wed Oct 29 15:15:29 2025
// --------------------------------------------------
/*
*/
PROJECT {
	title  = La_Dranse_2024_10_17
	author = anonymous_author
}
DOMAIN {
	multiregion = unnamed_multiregion
	PARALLEL {
		number_threads = 8
	}
	BASEPLANE_2D {
		region_name = La_Dranse_2024_10_17
		GEOMETRY {
			type = 2dm
			file = La Dranse 2024-10-17_computational-mesh.2dm
			STRINGDEF {
				name               = inflow
				node_ids           = (1494 793 685 898 687 683 1036 1413 554 599 552 1582)
				upstream_direction = right
			}
			STRINGDEF {
				name               = outflow
				node_ids           = (1506 313 1985 1764 583 595 1550)
				upstream_direction = right
			}
		}
		TIMESTEP {
			CFL                  = 0.9
			total_run_time       = 18000
			start_time           = 0
			minimum_time_step    = 0.001
			maximum_time_step    = 100.0
			initial_time_step    = 1.0
			ignore_wave_celerity = off
			morph_cycle          = off
		}
		HYDRAULICS {
			PARAMETER {
				minimum_water_depth            = 0.05
				riemann_solver                 = hllc
				simulation_scheme              = exp
				velocity_update_partial        = volume_area
				dynamic_depth_solver           = on
				dynamic_depth_solver_precision = 0.005
				geo_min_area_ratio             = 0.05
				geo_max_angle_quadrilateral    = 45
				geo_min_aspect_ratio           = 0.06
			}
			FRICTION {
				type                = manning
				default_friction    = 0.03
				input_type          = index_table
				index               = (1 2)
				friction            = (0.03 0.05)
				wall_friction       = on
				grain_size_friction = no
			}
			INITIAL {
				type                  = continue
				file                  = La_Dranse_2024_10_17_restart.cgns
				restart_solution_time = -1
			}
			BOUNDARY {
				name                 = inflow
				string_name          = inflow
				type                 = hydrograph
				file                 = Flood_3_15_10_2000_reduced_18000.txt
				slope                = 20.6
				max_interval         = 20
				number_of_iterations = 5000
				weighting_type       = conveyance
				dynamic_slope        = no
				precision            = -1.0
				wse_calc_method      = average
			}
			BOUNDARY {
				name            = outflow
				string_name     = outflow
				type            = hqrelation
				slope           = 2.0
				weighting_type  = conveyance
				wall_flux       = no
				dynamic_slope   = no
				wse_calc_method = average
				conveyance_type = tables
			}
		}
		MORPHOLOGY {
			PARAMETER {
				porosity                 = 37
				density                  = 2650
				control_volume_type      = constant
				control_volume_initial   = soildef
				create_new_layers        = off
				min_theta_critic         = 0.02
				local_slope_angle_repose = 30.0
				strong_coupling          = off
				distortion_offset        = 0
				distortion_time_interval = -1
			}
			BEDMATERIAL {
				GRAIN_CLASS {
					diameters = (24)
				}
				MIXTURE {
					name            = single
					volume_fraction = (100)
				}
				SOIL_DEF {
					name              = riverbed
					tau_erosion_start = -1.0
					LAYER {
						mixture          = single
						bottom_elevation = -5
					}
				}
				SOIL_DEF {
					name              = grass
					tau_erosion_start = -1.0
				}
				SOIL_ASSIGNMENT {
					index = (1 2)
					soil  = (riverbed grass)
					type  = index_table
				}
			}
			INITIAL {
				type = initial_mesh
			}
			BEDLOAD {
				FORMULA {
					bedload_formula                   = mpm
					bedload_factor                    = 0.61625
					bedload_exponent                  = 1.6
					theta_critical                    = (0.047 0.047)
					theta_critical_index              = (1 2)
					theta_critical_approach           = theta_critical_vanrijn
					local_slope_correction            = local_slope_vanrijn
					critical_shear_stress_calibration = 1.0
					bedforms_type                     = no_bedforms
				}
				BOUNDARY {
					name              = inflow
					type              = IOUp
					string_name       = inflow
					mixture           = single
					fraction_boundary = 1.0
				}
				BOUNDARY {
					name              = outflow
					type              = IODown
					string_name       = outflow
					fraction_boundary = 1.0
				}
				DIRECTION {
					lateral_transport_type     = lateral_bed_slope
					lateral_index              = (1 2)
					lateral_transport_factor   = 1.2
					lateral_transport_exponent = 0.5
					scale_lateral_transport    = yes
				}
				DIRECTION {
					lateral_transport_type          = curvature_effect_dynamic
					radius_calculation_type         = water_surface_elevation
					lateral_index                   = (1 2)
					min_abs_radius                  = 80
					curvature_transport_factor_type = fix
					curvature_transport_factor      = 7.0
					update_timestep_radius          = 1000
					initial_radius                  = 10000.0
					min_abs_radius_use              = significance_value
				}
				PARAMETER {
					bedload_routing_start          = 0.0
					limit_bedload_wetted           = on
					use_real_edge_lengths          = off
					use_cell_averaged_bedload_flux = off
				}
			}
		}
		OUTPUT {
			console_time_step = 1000
			restart_time_step = 18000
			SPECIAL_OUTPUT {
				type             = node_centered
				format           = sms
				values           = (depth velocity tau deltaz z_node bedload_vec)
				output_time_step = 1800
				threshold_wse    = -1000000
			}
			SPECIAL_OUTPUT {
				type                = boundary_history
				boundary_values     = (Q Qsed)
				output_time_step    = 900
				flush_all_num_steps = 0
				history_one_file    = no
				threshold_wse       = -1000000
			}
			SPECIAL_OUTPUT {
				type             = balance
				balance_values   = (timestep water_volume sediment)
				output_time_step = 1800
				threshold_wse    = -1000000
			}
		}
	}
	PHYSICAL_PROPERTIES {
		gravity   = 9.81
		viscosity = 1e-06
		rho_fluid = 1000
	}
}

/*
-> Domain: Input file has been successfully parsed and passed preliminary 
   validation
-> *** Start Simulation ***
-> OpenMP: Computation is executed in parallel using 8 threads
-> Domain Initialized
-> initialize domain done
-> initialize networkcommunication done
-> Definition of sediment parameters
-> BASEplane: Initialization of SubDomain 'La_Dranse_2024_10_17
-> Reserving the vectors for nodes, elements & edges
-> InputSMS: Number of Nodes = 2299
-> InputSMS: Number of Elements = 4367
-> Checking disjoint nodes ...
-> Checking the area of elements ...
-> Checking the aspect ratio of elements ...
-> Checking for concave quadrilateral elements ...
-> Checking for ambiguous quadrilateral elements ...
-> InputSMS: Number of Edges = 6665
-> InputSMS: Total mesh area = 28396.7 m2
-> Creating internal Grid for Sediment Transport...
-> Create Nodes of sediment grid...
-> Create Edges of sediment grid...
-> Create Elements of sediment grid...
-> Finished creating grid for Sediment Transport in 0.025 [s].
-> SedInput: Definition of soil mixtures
-> SedInput: Initialization of sediment sources (slk, sk, sfk)
-> SedInput: Initialization of soils and layers for sediment transport!
-> SedInput: Creating soils and interpolating data on cell-vertex mesh !
-> SedInput: Initialization of soil descriptions
-> SedInput: Initialization of cell-centered soils
-> SedInput: Interpolation of soils and mixtures on the sediment grid
-> SedInput: Initialization of bedload control volumes
-> SedInput: Initialization of fixed bed elevations
-> SedInput: Initialization of sublayer
-> SedInput: Preparing Theta critic
-> Bedload: Create the sediment mass balance object
-> Bedload: Initialize the conserved and temporary variables
-> Bedload: Initialization of bed load transport and parameters
-> Bedload: Definition of boundary conditions for bedload transport
-> Bedload: Checking for inner boundary conditions for bedload transport
-> Bedload: Initialization of bed forms
-> Bedload: Initialization of upwind factors
-> Bedload: Initialization of transport formula
-> OpenMP: Computation is executed in parallel using 8 threads
-> BASEplane: Determine first time step delta_t = 0.0822218
-> Domain: Starting time loop
TIME =  0.000000e+00	hyd. Time Step =   8.222180e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = -0.000000e+00 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 0.000000e+00 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.000000e+03	hyd. Time Step =   1.794411e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.078400e+01 [m3/s] (inflow)
 Qsed_in[1]  = 3.043392e-04 [m3/s] (inflow)
 Qout[2]     = 1.902613e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  2.000000e+03	hyd. Time Step =   2.392334e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.761309e+01 [m3/s] (inflow)
 Qsed_in[1]  = 5.368223e-05 [m3/s] (inflow)
 Qout[2]     = 1.924530e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  3.000000e+03	hyd. Time Step =   4.687763e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.652208e+01 [m3/s] (inflow)
 Qsed_in[1]  = 1.652155e-05 [m3/s] (inflow)
 Qout[2]     = 1.719416e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  4.000000e+03	hyd. Time Step =   1.748135e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.488903e+01 [m3/s] (inflow)
 Qsed_in[1]  = 1.225274e-05 [m3/s] (inflow)
 Qout[2]     = 1.589229e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  5.000000e+03	hyd. Time Step =   2.948501e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.677699e+01 [m3/s] (inflow)
 Qsed_in[1]  = 9.814515e-05 [m3/s] (inflow)
 Qout[2]     = 1.611425e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  6.000000e+03	hyd. Time Step =   6.365175e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.711896e+01 [m3/s] (inflow)
 Qsed_in[1]  = 8.189664e-05 [m3/s] (inflow)
 Qout[2]     = 1.688772e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  7.000000e+03	hyd. Time Step =   1.670516e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.983201e+01 [m3/s] (inflow)
 Qsed_in[1]  = 1.739663e-03 [m3/s] (inflow)
 Qout[2]     = 1.962976e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  8.000000e+03	hyd. Time Step =   5.573613e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.980333e+01 [m3/s] (inflow)
 Qsed_in[1]  = 7.458546e-04 [m3/s] (inflow)
 Qout[2]     = 1.977817e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  9.000000e+03	hyd. Time Step =   3.830812e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.927406e+01 [m3/s] (inflow)
 Qsed_in[1]  = 1.860477e-03 [m3/s] (inflow)
 Qout[2]     = 1.975357e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.000000e+04	hyd. Time Step =   6.179433e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.085967e+01 [m3/s] (inflow)
 Qsed_in[1]  = 1.802089e-03 [m3/s] (inflow)
 Qout[2]     = 1.956034e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.100000e+04	hyd. Time Step =   5.506883e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.179277e+01 [m3/s] (inflow)
 Qsed_in[1]  = 2.847010e-03 [m3/s] (inflow)
 Qout[2]     = 2.089077e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.200000e+04	hyd. Time Step =   7.123797e-03 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.236200e+01 [m3/s] (inflow)
 Qsed_in[1]  = 2.909969e-02 [m3/s] (inflow)
 Qout[2]     = 2.230880e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.300000e+04	hyd. Time Step =   1.519390e-03 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.279566e+01 [m3/s] (inflow)
 Qsed_in[1]  = 1.589379e-01 [m3/s] (inflow)
 Qout[2]     = 2.235896e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.400000e+04	hyd. Time Step =   4.181786e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.664328e+01 [m3/s] (inflow)
 Qsed_in[1]  = 7.546739e-03 [m3/s] (inflow)
 Qout[2]     = 2.577986e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.500000e+04	hyd. Time Step =   1.345106e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.705497e+01 [m3/s] (inflow)
 Qsed_in[1]  = 2.379557e-02 [m3/s] (inflow)
 Qout[2]     = 2.662515e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.600000e+04	hyd. Time Step =   1.000000e-03 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 3.114033e+01 [m3/s] (inflow)
 Qsed_in[1]  = 4.053656e-01 [m3/s] (inflow)
 Qout[2]     = 2.949170e+01 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.700000e+04	hyd. Time Step =   4.675637e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 3.693029e+01 [m3/s] (inflow)
 Qsed_in[1]  = 1.084229e-02 [m3/s] (inflow)
 Qout[2]     = 3.421567e+01 [m3/s] (outflow)
 Qsed_out[2] = 4.872272e-06 [m3/s] (outflow)
TIME =  1.800000e+04	hyd. Time Step =   8.212566e-03 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 4.514093e+01 [m3/s] (inflow)
 Qsed_in[1]  = 7.788186e-02 [m3/s] (inflow)
 Qout[2]     = 4.189543e+01 [m3/s] (outflow)
 Qsed_out[2] = 3.380358e-04 [m3/s] (outflow)
-> Domain: Run Time of the simulation= 952.745 sec
-> Domain: Finished simulation.

*/
