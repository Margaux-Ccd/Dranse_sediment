// --------------------------------------------------
// BASEMENT log file:
// Version:  v2.8.2// bmc file: C:\Users\marga\Documents\EPFL\Cours\S3\Dranse\BASEMENT_model\Dranse_sediment/Dranse_reduced.bmc
// started:  Thu Oct 30 11:54:38 2025
// --------------------------------------------------
/*
*/
PROJECT {
	title  = La_Dranse_2024_10_17
	author = anonymous_author
}
DOMAIN {
	multiregion = unnamed_multiregion
	PARALLEL {
		number_threads = 8
	}
	BASEPLANE_2D {
		region_name = La_Dranse_2024_10_17
		GEOMETRY {
			type = 2dm
			file = Dranse_elevation_mesh_4th_bathymetry.2dm
			STRINGDEF {
				name               = inflow
				node_ids           = (1494 793 685 898 687 683 1036 1413 554 599 552 1582)
				upstream_direction = right
			}
			STRINGDEF {
				name               = outflow
				node_ids           = (1506 313 1985 1764 583 595 1550)
				upstream_direction = right
			}
		}
		TIMESTEP {
			CFL                  = 0.9
			total_run_time       = 18000
			start_time           = 0
			minimum_time_step    = 0.001
			maximum_time_step    = 100.0
			initial_time_step    = 1.0
			ignore_wave_celerity = off
			morph_cycle          = off
		}
		HYDRAULICS {
			PARAMETER {
				minimum_water_depth            = 0.05
				riemann_solver                 = hllc
				simulation_scheme              = exp
				velocity_update_partial        = volume_area
				dynamic_depth_solver           = on
				dynamic_depth_solver_precision = 0.005
				geo_min_area_ratio             = 0.05
				geo_max_angle_quadrilateral    = 45
				geo_min_aspect_ratio           = 0.06
			}
			FRICTION {
				type                = manning
				default_friction    = 0.03
				input_type          = index_table
				index               = (1 2)
				friction            = (0.03 0.05)
				wall_friction       = on
				grain_size_friction = no
			}
			INITIAL {
				type                  = continue
				file                  = La_Dranse_2024_10_17_restart.cgns
				restart_solution_time = -1
			}
			BOUNDARY {
				name                 = inflow
				string_name          = inflow
				type                 = hydrograph
				file                 = Flood_3_15_10_2000_reduced_18000.txt
				slope                = 20.6
				max_interval         = 20
				number_of_iterations = 5000
				weighting_type       = conveyance
				dynamic_slope        = no
				precision            = -1.0
				wse_calc_method      = average
			}
			BOUNDARY {
				name            = outflow
				string_name     = outflow
				type            = hqrelation
				slope           = 2.0
				weighting_type  = conveyance
				wall_flux       = no
				dynamic_slope   = no
				wse_calc_method = average
				conveyance_type = tables
			}
		}
		MORPHOLOGY {
			PARAMETER {
				porosity                 = 37
				density                  = 2650
				control_volume_type      = constant
				control_volume_initial   = soildef
				create_new_layers        = off
				min_theta_critic         = 0.02
				local_slope_angle_repose = 30.0
				strong_coupling          = off
				distortion_offset        = 0
				distortion_time_interval = -1
			}
			BEDMATERIAL {
				GRAIN_CLASS {
					diameters = (7 20 33 46 59	)
				}
				MIXTURE {
					name            = Sample_1
					volume_fraction = (36.4 20.6 11.8 16.0 15.2)
				}
				SOIL_DEF {
					name              = riverbed
					tau_erosion_start = -1.0
					LAYER {
						mixture          = Sample_1
						bottom_elevation = -5
					}
				}
				SOIL_DEF {
					name              = grass
					tau_erosion_start = -1.0
				}
				SOIL_ASSIGNMENT {
					index = (1 2)
					soil  = (riverbed grass)
					type  = index_table
				}
			}
			INITIAL {
				type = initial_mesh
			}
			BEDLOAD {
				FORMULA {
					bedload_formula                   = mpm_multi
					bedload_factor                    = 0.61625
					bedload_exponent                  = 1.6
					theta_critical                    = (0.055 0.055)
					theta_critical_index              = (1 2)
					theta_critical_approach           = theta_critical_vanrijn
					theta_critical_hiding             = mean
					local_slope_correction            = local_slope_vanrijn
					critical_shear_stress_calibration = 1.0
					bedforms_type                     = no_bedforms
				}
				BOUNDARY {
					name              = inflow
					type              = IOUp
					string_name       = inflow
					mixture           = Sample_1
					fraction_boundary = 1.0
				}
				BOUNDARY {
					name              = outflow
					type              = IODown
					string_name       = outflow
					fraction_boundary = 1.0
				}
				DIRECTION {
					lateral_transport_type     = lateral_bed_slope
					lateral_index              = (1 2)
					lateral_transport_factor   = 1.2
					lateral_transport_exponent = 0.5
					scale_lateral_transport    = yes
				}
				DIRECTION {
					lateral_transport_type          = curvature_effect_dynamic
					radius_calculation_type         = water_surface_elevation
					lateral_index                   = (1 2)
					min_abs_radius                  = 80
					curvature_transport_factor_type = fix
					curvature_transport_factor      = 7.0
					update_timestep_radius          = 1000
					initial_radius                  = 10000.0
					min_abs_radius_use              = significance_value
				}
				PARAMETER {
					bedload_routing_start          = 0.0
					limit_bedload_wetted           = on
					use_real_edge_lengths          = off
					use_cell_averaged_bedload_flux = off
				}
			}
		}
		OUTPUT {
			console_time_step = 1000
			restart_time_step = 18000
			SPECIAL_OUTPUT {
				type             = node_centered
				format           = sms
				values           = (depth velocity tau deltaz z_node bedload_vec)
				output_time_step = 1800
				threshold_wse    = -1000000
			}
			SPECIAL_OUTPUT {
				type                = boundary_history
				boundary_values     = (Q Qsed)
				output_time_step    = 900
				flush_all_num_steps = 0
				history_one_file    = no
				threshold_wse       = -1000000
			}
			SPECIAL_OUTPUT {
				type             = balance
				balance_values   = (timestep water_volume sediment)
				output_time_step = 1800
				threshold_wse    = -1000000
			}
		}
	}
	PHYSICAL_PROPERTIES {
		gravity   = 9.81
		viscosity = 1e-06
		rho_fluid = 1000
	}
}

/*
-> Domain: Input file has been successfully parsed and passed preliminary 
   validation
-> *** Start Simulation ***
-> OpenMP: Computation is executed in parallel using 8 threads
-> Domain Initialized
-> initialize domain done
-> initialize networkcommunication done
-> Definition of sediment parameters
-> BASEplane: Initialization of SubDomain 'La_Dranse_2024_10_17
-> Reserving the vectors for nodes, elements & edges
-> InputSMS: Number of Nodes = 2299
-> InputSMS: Number of Elements = 4367
-> Checking disjoint nodes ...
-> Checking the area of elements ...
-> Checking the aspect ratio of elements ...
-> Checking for concave quadrilateral elements ...
-> Checking for ambiguous quadrilateral elements ...
-> InputSMS: Number of Edges = 6665
-> InputSMS: Total mesh area = 28396.7 m2
-> Creating internal Grid for Sediment Transport...
-> Create Nodes of sediment grid...
-> Create Edges of sediment grid...
-> Create Elements of sediment grid...
-> Finished creating grid for Sediment Transport in 0.064 [s].
-> SedInput: Definition of soil mixtures
-> SedInput: Initialization of sediment sources (slk, sk, sfk)
-> SedInput: Initialization of soils and layers for sediment transport!
-> SedInput: Creating soils and interpolating data on cell-vertex mesh !
-> SedInput: Initialization of soil descriptions
-> SedInput: Initialization of cell-centered soils
-> SedInput: Interpolation of soils and mixtures on the sediment grid
-> SedInput: Initialization of bedload control volumes
-> SedInput: Initialization of fixed bed elevations
-> SedInput: Initialization of sublayer
-> SedInput: Preparing Theta critic
-> Bedload: Create the sediment mass balance object
-> Bedload: Initialize the conserved and temporary variables
-> Bedload: Initialization of bed load transport and parameters
-> Bedload: Definition of boundary conditions for bedload transport
-> Bedload: Checking for inner boundary conditions for bedload transport
-> Bedload: Initialization of bed forms
-> Bedload: Initialization of upwind factors
-> Bedload: Initialization of transport formula
-> OpenMP: Computation is executed in parallel using 8 threads
-> BASEplane: Determine first time step delta_t = 0.0503289
-> Domain: Starting time loop
TIME =  0.000000e+00	hyd. Time Step =   5.032894e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = -0.000000e+00 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 0.000000e+00 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.000000e+03	hyd. Time Step =   3.707831e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.078400e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 2.066931e+01 [m3/s] (outflow)
 Qsed_out[2] = 1.704943e-04 [m3/s] (outflow)
TIME =  2.000000e+03	hyd. Time Step =   1.136826e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.761304e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 1.949727e+01 [m3/s] (outflow)
 Qsed_out[2] = 2.067441e-05 [m3/s] (outflow)
TIME =  3.000000e+03	hyd. Time Step =   3.030568e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.652205e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 1.735981e+01 [m3/s] (outflow)
 Qsed_out[2] = 2.914114e-06 [m3/s] (outflow)
TIME =  4.000000e+03	hyd. Time Step =   3.129433e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.488905e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 1.585396e+01 [m3/s] (outflow)
 Qsed_out[2] = 9.196092e-07 [m3/s] (outflow)
TIME =  5.000000e+03	hyd. Time Step =   2.441890e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.677699e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 1.608260e+01 [m3/s] (outflow)
 Qsed_out[2] = 1.450336e-06 [m3/s] (outflow)
TIME =  6.000000e+03	hyd. Time Step =   2.803756e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.711898e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 1.683470e+01 [m3/s] (outflow)
 Qsed_out[2] = 2.244191e-06 [m3/s] (outflow)
TIME =  7.000000e+03	hyd. Time Step =   1.797054e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.983201e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 1.928702e+01 [m3/s] (outflow)
 Qsed_out[2] = 1.219365e-05 [m3/s] (outflow)
TIME =  8.000000e+03	hyd. Time Step =   4.201907e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.980333e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 1.970618e+01 [m3/s] (outflow)
 Qsed_out[2] = 6.190418e-06 [m3/s] (outflow)
TIME =  9.000000e+03	hyd. Time Step =   6.015416e-03 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.927401e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 1.975306e+01 [m3/s] (outflow)
 Qsed_out[2] = 6.443976e-05 [m3/s] (outflow)
TIME =  1.000000e+04	hyd. Time Step =   2.923028e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.085967e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 1.956335e+01 [m3/s] (outflow)
 Qsed_out[2] = 1.546549e-05 [m3/s] (outflow)
TIME =  1.100000e+04	hyd. Time Step =   4.013534e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.179283e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 2.077749e+01 [m3/s] (outflow)
 Qsed_out[2] = 1.187163e-03 [m3/s] (outflow)
TIME =  1.200000e+04	hyd. Time Step =   2.332202e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.236200e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 2.217141e+01 [m3/s] (outflow)
 Qsed_out[2] = 4.039043e-04 [m3/s] (outflow)
TIME =  1.300000e+04	hyd. Time Step =   3.710786e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.279550e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 2.233756e+01 [m3/s] (outflow)
 Qsed_out[2] = 2.380724e-04 [m3/s] (outflow)
TIME =  1.400000e+04	hyd. Time Step =   3.589598e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.664329e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 2.531389e+01 [m3/s] (outflow)
 Qsed_out[2] = 2.696304e-04 [m3/s] (outflow)
TIME =  1.500000e+04	hyd. Time Step =   2.948647e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 2.705494e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 2.654284e+01 [m3/s] (outflow)
 Qsed_out[2] = 3.495347e-04 [m3/s] (outflow)
TIME =  1.600000e+04	hyd. Time Step =   3.675212e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 3.114017e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 2.913006e+01 [m3/s] (outflow)
 Qsed_out[2] = 3.123876e-04 [m3/s] (outflow)
TIME =  1.700000e+04	hyd. Time Step =   3.350249e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 3.693040e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 3.372250e+01 [m3/s] (outflow)
 Qsed_out[2] = 4.000601e-04 [m3/s] (outflow)
TIME =  1.800000e+04	hyd. Time Step =   1.726106e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 4.514085e+01 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 4.120076e+01 [m3/s] (outflow)
 Qsed_out[2] = 1.051641e-03 [m3/s] (outflow)
-> Domain: Run Time of the simulation= 4335.81 sec
-> Domain: Finished simulation.

*/
