// --------------------------------------------------
// BASEMENT log file:
// Version:  v2.8.2// bmc file: C:\Users\marga\Documents\EPFL\Cours\S3\Dranse\BASEMENT_model\Dranse_sediment/Dranse_Morphodynamic.bmc
// started:  Mon Nov 10 18:19:03 2025
// --------------------------------------------------
/*
*/
PROJECT {
	title  = La_Dranse_2024_10_17
	author = anonymous_author
}
DOMAIN {
	multiregion = unnamed_multiregion
	PARALLEL {
		number_threads = 8
	}
	BASEPLANE_2D {
		region_name = La_Dranse_2024_10_17
		GEOMETRY {
			type = 2dm
			file = Dranse_computational_mesh_10_11_25.2dm
			STRINGDEF {
				name               = inflow
				node_ids           = (331 557 1854 1836 1855 1853 499 1960 1890 1935 1937 317)
				upstream_direction = right
			}
			STRINGDEF {
				name               = outflow
				node_ids           = (241 786 2005 710 1919 1931 285)
				upstream_direction = right
			}
		}
		TIMESTEP {
			CFL                  = 0.9
			total_run_time       = 2000
			start_time           = 0
			minimum_time_step    = 0.001
			maximum_time_step    = 100.0
			initial_time_step    = 1.0
			ignore_wave_celerity = off
			morph_cycle          = off
		}
		HYDRAULICS {
			PARAMETER {
				minimum_water_depth            = 0.05
				riemann_solver                 = hllc
				simulation_scheme              = exp
				velocity_update_partial        = volume_area
				dynamic_depth_solver           = on
				dynamic_depth_solver_precision = 0.005
				geo_min_area_ratio             = 0.05
				geo_max_angle_quadrilateral    = 45
				geo_min_aspect_ratio           = 0.06
			}
			FRICTION {
				type                = manning
				default_friction    = 0.03
				input_type          = index_table
				index               = (1 2)
				friction            = (0.03 0.05)
				wall_friction       = on
				grain_size_friction = no
			}
			INITIAL {
				type                  = continue
				file                  = La_Dranse_2024_10_17_restart_10-11-25.cgns
				restart_solution_time = 10000
			}
			BOUNDARY {
				name                 = inflow
				string_name          = inflow
				type                 = hydrograph
				file                 = Discharge_scanperiod_5min.txt
				slope                = 20.6
				max_interval         = 20
				number_of_iterations = 5000
				weighting_type       = conveyance
				dynamic_slope        = no
				precision            = -1.0
				wse_calc_method      = average
			}
			BOUNDARY {
				name            = outflow
				string_name     = outflow
				type            = hqrelation
				slope           = 2.0
				weighting_type  = conveyance
				wall_flux       = no
				dynamic_slope   = no
				wse_calc_method = average
				conveyance_type = tables
			}
		}
		MORPHOLOGY {
			PARAMETER {
				porosity                 = 37
				density                  = 2650
				control_volume_type      = constant
				control_volume_initial   = soildef
				create_new_layers        = off
				min_theta_critic         = 0.02
				local_slope_angle_repose = 30.0
				strong_coupling          = off
				distortion_offset        = 0
				distortion_time_interval = -1
			}
			BEDMATERIAL {
				GRAIN_CLASS {
					diameters = (24)
				}
				MIXTURE {
					name            = single
					volume_fraction = (100)
				}
				SOIL_DEF {
					name              = riverbed
					tau_erosion_start = -1.0
					LAYER {
						mixture          = single
						bottom_elevation = -5
					}
				}
				SOIL_DEF {
					name              = grass
					tau_erosion_start = -1.0
				}
				SOIL_ASSIGNMENT {
					index = (1 2)
					soil  = (riverbed grass)
					type  = index_table
				}
			}
			INITIAL {
				type = initial_mesh
			}
			BEDLOAD {
				FORMULA {
					bedload_formula                   = mpm
					bedload_factor                    = 0.61625
					bedload_exponent                  = 1.6
					theta_critical                    = (0.055 0.055)
					theta_critical_index              = (1 2)
					theta_critical_approach           = theta_critical_vanrijn
					local_slope_correction            = local_slope_vanrijn
					critical_shear_stress_calibration = 1.0
					bedforms_type                     = no_bedforms
				}
				BOUNDARY {
					name        = inflow
					type        = transport_capacity
					string_name = inflow
					mixture     = single
					factor      = 1.0
				}
				BOUNDARY {
					name              = outflow
					type              = IODown
					string_name       = outflow
					fraction_boundary = 1.0
				}
				DIRECTION {
					lateral_transport_type     = lateral_bed_slope
					lateral_index              = (1 2)
					lateral_transport_factor   = 1.2
					lateral_transport_exponent = 0.5
					scale_lateral_transport    = yes
				}
				DIRECTION {
					lateral_transport_type          = curvature_effect_dynamic
					radius_calculation_type         = water_surface_elevation
					lateral_index                   = (1 2)
					min_abs_radius                  = 80
					curvature_transport_factor_type = fix
					curvature_transport_factor      = 7.0
					update_timestep_radius          = 1000
					initial_radius                  = 10000.0
					min_abs_radius_use              = significance_value
				}
				PARAMETER {
					bedload_routing_start          = 0.0
					limit_bedload_wetted           = on
					use_real_edge_lengths          = off
					use_cell_averaged_bedload_flux = off
				}
			}
		}
		OUTPUT {
			console_time_step = 1000
			restart_time_step = 100000
			SPECIAL_OUTPUT {
				type             = node_centered
				format           = sms
				values           = (depth velocity tau deltaz z_node bedload_vec)
				output_time_step = 1800
				threshold_wse    = -1000000
			}
			SPECIAL_OUTPUT {
				type                = boundary_history
				boundary_values     = (Q Qsed)
				output_time_step    = 900
				flush_all_num_steps = 0
				history_one_file    = no
				threshold_wse       = -1000000
			}
			SPECIAL_OUTPUT {
				type             = balance
				balance_values   = (timestep water_volume sediment)
				output_time_step = 1800
				threshold_wse    = -1000000
			}
		}
	}
	PHYSICAL_PROPERTIES {
		gravity   = 9.81
		viscosity = 1e-06
		rho_fluid = 1000
	}
}

/*
-> Domain: Input file has been successfully parsed and passed preliminary 
   validation
-> *** Start Simulation ***
-> OpenMP: Computation is executed in parallel using 8 threads
-> Domain Initialized
-> initialize domain done
-> initialize networkcommunication done
-> Definition of sediment parameters
-> BASEplane: Initialization of SubDomain 'La_Dranse_2024_10_17
-> Reserving the vectors for nodes, elements & edges
-> InputSMS: Number of Nodes = 2299
-> InputSMS: Number of Elements = 4367
-> Checking disjoint nodes ...
-> Checking the area of elements ...
-> Checking the aspect ratio of elements ...
-> Checking for concave quadrilateral elements ...
-> Checking for ambiguous quadrilateral elements ...
-> InputSMS: Number of Edges = 6665
-> InputSMS: Total mesh area = 28396.7 m2
-> Creating internal Grid for Sediment Transport...
-> Create Nodes of sediment grid...
-> Create Edges of sediment grid...
-> Create Elements of sediment grid...
-> Finished creating grid for Sediment Transport in 0.026 [s].
-> SedInput: Definition of soil mixtures
-> SedInput: Initialization of sediment sources (slk, sk, sfk)
-> SedInput: Initialization of soils and layers for sediment transport!
-> SedInput: Creating soils and interpolating data on cell-vertex mesh !
-> SedInput: Initialization of soil descriptions
-> SedInput: Initialization of cell-centered soils
-> SedInput: Interpolation of soils and mixtures on the sediment grid
-> SedInput: Initialization of bedload control volumes
-> SedInput: Initialization of fixed bed elevations
-> SedInput: Initialization of sublayer
-> SedInput: Preparing Theta critic
-> Bedload: Create the sediment mass balance object
-> Bedload: Initialize the conserved and temporary variables
-> Bedload: Initialization of bed load transport and parameters
-> Bedload: Definition of boundary conditions for bedload transport
-> Bedload: Checking for inner boundary conditions for bedload transport
-> Bedload: Initialization of bed forms
-> Bedload: Initialization of upwind factors
-> Bedload: Initialization of transport formula
-> OpenMP: Computation is executed in parallel using 8 threads
-> BASEplane: Determine first time step delta_t = 0.0569728
-> Domain: Starting time loop
TIME =  0.000000e+00	hyd. Time Step =   5.697279e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = -0.000000e+00 [m3/s] (inflow)
 Qsed_in[1]  = 0.000000e+00 [m3/s] (inflow)
 Qout[2]     = 0.000000e+00 [m3/s] (outflow)
 Qsed_out[2] = 0.000000e+00 [m3/s] (outflow)
TIME =  1.000000e+03	hyd. Time Step =   4.008632e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.308200e+01 [m3/s] (inflow)
 Qsed_in[1]  = 9.778085e-02 [m3/s] (inflow)
 Qout[2]     = 1.313684e+01 [m3/s] (outflow)
 Qsed_out[2] = 8.315330e-06 [m3/s] (outflow)
TIME =  2.000000e+03	hyd. Time Step =   2.921865e-02 (SD: La_Dranse_2024_10_17)
 Qin[1]      = 1.308200e+01 [m3/s] (inflow)
 Qsed_in[1]  = 9.574020e-02 [m3/s] (inflow)
 Qout[2]     = 1.314863e+01 [m3/s] (outflow)
 Qsed_out[2] = 1.154890e-05 [m3/s] (outflow)
-> Domain: Run Time of the simulation= 146.483 sec
-> Domain: Finished simulation.

*/
